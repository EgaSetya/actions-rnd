name: PR Activity Notifier

on:
  pull_request:
    types: [opened, closed, reopened, edited, ready_for_review, review_requested, assigned, unassigned, labeled, unlabeled, synchronize]
  pull_request_review:
    types: [submitted, edited, dismissed]
  pull_request_review_comment:
    types: [edited, deleted]  # Removed 'created' here since we'll handle new comments via pull_request_review

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Set Action Type
        id: action
        run: |
          # For main PR events
          if [[ "${{ github.event_name }}" == "pull_request" ]]; then
            case "${{ github.event.action }}" in
              "opened")
                echo "icon=ðŸ†•" >> $GITHUB_OUTPUT
                echo "action_text=New PR Opened" >> $GITHUB_OUTPUT
                ;;
              "closed")
                if [[ "${{ github.event.pull_request.merged }}" == "true" ]]; then
                  echo "icon=ðŸŽ‰" >> $GITHUB_OUTPUT
                  echo "action_text=PR Merged" >> $GITHUB_OUTPUT
                else
                  echo "icon=âŒ" >> $GITHUB_OUTPUT
                  echo "action_text=PR Closed" >> $GITHUB_OUTPUT
                fi
                ;;
              "reopened")
                echo "icon=ðŸ”„" >> $GITHUB_OUTPUT
                echo "action_text=PR Reopened" >> $GITHUB_OUTPUT
                ;;
              "ready_for_review")
                echo "icon=ðŸ‘€" >> $GITHUB_OUTPUT
                echo "action_text=PR Ready for Review" >> $GITHUB_OUTPUT
                ;;
              "review_requested")
                echo "icon=ðŸ“‹" >> $GITHUB_OUTPUT
                echo "action_text=Review Requested" >> $GITHUB_OUTPUT
                ;;
              "synchronize")
                echo "icon=ðŸ“" >> $GITHUB_OUTPUT
                echo "action_text=New Commit Pushed" >> $GITHUB_OUTPUT
                ;;
              *)
                echo "icon=ðŸ“" >> $GITHUB_OUTPUT
                echo "action_text=PR Updated" >> $GITHUB_OUTPUT
                ;;
            esac
          # For PR review events
          elif [[ "${{ github.event_name }}" == "pull_request_review" ]]; then
            case "${{ github.event.review.state }}" in
              "approved")
                echo "icon=âœ…" >> $GITHUB_OUTPUT
                echo "action_text=PR Approved" >> $GITHUB_OUTPUT
                ;;
              "changes_requested")
                echo "icon=âš ï¸" >> $GITHUB_OUTPUT
                echo "action_text=Changes Requested" >> $GITHUB_OUTPUT
                ;;
              "commented")
                echo "icon=ðŸ’­" >> $GITHUB_OUTPUT
                echo "action_text=Review Comment Added" >> $GITHUB_OUTPUT
                ;;
            esac
          # For PR review comment events (now only for edits and deletions)
          else
            case "${{ github.event.action }}" in
              "edited")
                echo "icon=âœï¸" >> $GITHUB_OUTPUT
                echo "action_text=Review Comment Edited" >> $GITHUB_OUTPUT
                ;;
              "deleted")
                echo "icon=ðŸ—‘ï¸" >> $GITHUB_OUTPUT
                echo "action_text=Review Comment Deleted" >> $GITHUB_OUTPUT
                ;;
            esac
          fi

      # Rest of the workflow remains the same...
